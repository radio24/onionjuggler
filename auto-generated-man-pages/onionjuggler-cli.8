.\" Automatically generated by Pandoc 2.9.2.1
.\"
.TH "ONIONJUGGLER-CLI" "8" "2022-08-29" "onionjuggler-cli 0.0.1" "Tor's System Manager Manual"
.hy
.SH NAME
.PP
onionjuggler-cli - Dinamically juggle with onion services with a POSIX
compliant shell
.SH SYNOPSIS
.PP
\f[B]onionjuggler-cli\f[R] [\f[B]--option\f[R]<=\f[I]ARGUMENT\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --on\f[R]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
[\f[B]--hs-version\f[R]=<\f[I]VERSION\f[R]>]
[\f[B]--socket\f[R]=<\f[I]tcp\f[R]>]
[\f[B]--port\f[R]=<\f[I]VIRTPORT\f[R][:\f[I]TARGET\f[R]],[\f[I]VIRTPORTn\f[R]][:\f[I]TARGETn\f[R]]>]
[\f[B]--gateway\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --on\f[R]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
[\f[B]--version\f[R]=<\f[I]VERSION\f[R]>]
[\f[B]--socket\f[R]=<\f[I]unix\f[R]>]
[\f[B]--port\f[R]=[\f[I]VIRTPORT\f[R],[\f[I]VIRTPORT2\f[R]]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --off\f[R]
[\f[B]--service\f[R]=<\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
[\f[B]--purge\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --list\f[R]
[\f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
[\f[B]--quiet\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli --renew\f[R]
[\f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli\f[R]
[\f[B]--signal\f[R]=<\f[I]reload\f[R]|\f[I]restart\f[R]|\f[I]none\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli [--getconf]\f[R]
.PD 0
.P
.PD
\f[B]onionjuggler-cli [--getopt]\f[R]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli [-V|--version]\f[R]
.PD 0
.P
.PD
\f[B]onionjuggler-cli\f[R] [\f[B]-h\f[R]|\f[B]--help\f[R]]
.SH DESCRIPTION
.PP
\f[B]onionjuggler-cli\f[R] helps onion service creation, deletion,
listing.
.SH OPTIONS
.TP
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERV\f[R]> \f[B]--version\f[R]=\f[I]3\f[R] \f[B]--socket\f[R]=\f[I]tcp\f[R] \f[B]--port\f[R]=<\f[I]VIRTPORT\f[R]:<\f[I]TARGET\f[R]>,<\f[I]VIRTPORTn\f[R]>:<\f[I]TARGETn\f[R]>> \f[B]--gateway\f[R]
Enable an onion service using TCP socket (addr:port) as target.
If the TARGET is only the port of it TARGET was not provided, will use
the same port as VIRTPORT and bind to 127.0.0.1.
TARGET examples: 127.0.0.1:80, 192.168.1.100:80.
File(s) modified: torrc.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --on --service=ssh --version=3 --socket=tcp --port=22
onionjuggler-cli --on --service=ssh --port=22:127.0.1:22
onionjuggler-cli --on --service=ssh --port=\[dq]80:127.0.0.1:80 443:127.0.0.1:443\[dq]
onionjuggler-cli --on --service=ssh --port=\[dq]80:127.0.0.1:80,443:127.0.0.1:443\[dq]
onionjuggler-cli --on --service=ssh --port=\[dq]80,443\[dq]
\f[R]
.fi
.PP
By default, services created on a Qubes-Whonix Gateway uses the Whonix
Workstation qube IP address, services created on a Non-Qubes-Whonix uses
the IP address 10.152.152.11.
If you are on Whonix Gateway want to enforce the creation of a service
to be running on the Whonix-Gateway (for itself), for example and onion
service to ssh to the Gateway, and you haven\[aq]t set the target, just
the virtual port, use the option \f[I]--gateway\f[R]:
.IP
.nf
\f[C]
onionjuggler-cli --on --service=ssh --socket=tcp --port=22 --gateway
\f[R]
.fi
.RE
.TP
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERV\f[R]> \f[B]--version\f[R]=\f[I]3\f[R] \f[B]--socket\f[R]=\f[I]unix\f[R] \f[B]--port\f[R]=<\f[I]VIRTPORT\f[R],<\f[I]VIRTPORT2\f[R]>>
Enable an onion service using UNIX socket (unix:path) as target.
The TARGET is handled automatically by the script.
This method avoids leaking the onion service address to the local
network.
File(s) modified: torrc.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --on --service=ssh --version=3 --socket=unix --port=22
onionjuggler-cli --on --service=ssh --version=3 --socket=unix --port=22,80
\f[R]
.fi
.RE
.TP
\f[B]--off\f[R] \f[B]--service\f[R]=<\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]> <\f[I]--purge\f[R]>
Disable an onion service by removing it configuration lines
(HiddenService) from the torrc.
Optionally purge its data directory, which will delete permanently the
onion service folder (HiddenServiceDir).
File(s) modified: torrc and optionally HiddenServiceDir.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --off --service=ssh
onionjuggler-cli --off --service=ssh,xmpp
onionjuggler-cli --off --service=ssh,xmpp --purge
\f[R]
.fi
.RE
.TP
\f[B]--list\f[R] \f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]> <\f[I]--quiet\f[R]>
List onion service information: hostname (address) and in QR encoded
format, clients names and quantity, status if service is active or
inactive regarding the torrc lines (un)present and the HiddenServiceDir
presence, the torrc block.
File(s) modified: none.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --list --service=ssh
onionjuggler-cli --list --service=ssh,xmpp
onionjuggler-cli --list --service=\[at]all
onionjuggler-cli --list --service=\[at]all --quiet
\f[R]
.fi
.RE
.TP
\f[B]--renew\f[R] \f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>
Renew onion service hostname (.onion domain) and clients (inside
HiddenServiceDir/authorized_clients/).
The onion service keys (hs_ed25519_public_key and
hs_ed25519_private_key) will be removed to override the hostname file.
File(s) modified: HiddenServiceDir.
.RS
.IP
.nf
\f[C]
onionjuggler-cli --renew --service=ssh
onionjuggler-cli --renew --service=ssh,xmpp
onionjuggler-cli --renew --service=\[at]all
\f[R]
.fi
.RE
.TP
\f[B]-V\f[R], \f[B]--version\f[R]
Print version information.
.TP
\f[B]--getconf\f[R]
Print configuration in the format \f[B]key\f[R]=\[dq]\f[I]val\f[R]\[dq].
.TP
\f[B]--getopt\f[R]
Print option parsing results.
.TP
\f[B]--signal\f[R]=<\f[I]reload\f[R]|\f[I]hup\f[R]|\f[I]restart\f[R]|\f[I]int\f[R]|\f[I]no\f[R]|\f[I]none\f[R]>
Send specific signal commands to the tor daemon.
Sending the \f[I]restart|int\f[R] signal is useful for correcting a
previously broken tor configuration.
Sending \f[I]no|none\f[R] signal is useful when running consecutive
commands to avoid tor signaling newnym everytime tor is hupped, then at
last signal tor hup to tor reload its configuration and apply changes.
(Default: reload|hup).
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Display the script help message.
Abscense of any parameter will also have the same effect.
.RS
.IP
.nf
\f[C]
onionjuggler-cli -h
onionjuggler-cli --help
\f[R]
.fi
.RE
.SH ENVIRONMENT
.TP
\f[B]ONIONJUGGLER_SKIP_PRE_TOR_CHECK\f[R]
If set to 1, skip pre run tor check to allow the script to start running
if the tor is failing to parse its configuration.
Note it does not disable the last tor check to apply configuration
changes, that is, if the configuration is still invalid, nothing will be
changed.
This option is useful if you are certain the configuration check will be
fixed by the command.
As the scripts requires root and you are probably calling the script
from an unpriviliged user, preserve the variable value through
environment changes by assigning it after the command to run the
onionjuggler script as another user and before the script name:
.RS
.IP
.nf
\f[C]
sudo ONIONJUGGLER_SKIP_PRE_TOR_CHECK=1 onionjuggler-cli
doas ONIONJUGGLER_SKIP_PRE_TOR_CHECK=1 onionjuggler-cli
\f[R]
.fi
.RE
.SH FILES
.TP
\f[B]/usr/share/onionjuggler/defaults.sh\f[R]
Default library
.TP
\f[B]/etc/onionjuggler/onionjuggler.conf\f[R]
Default system configuration file.
.TP
\f[B]/etc/onionjuggler/conf.d/*.conf\f[R]
Local configuration files that overrrite the default one.
.SH EXIT VALUE
.TP
\f[B]0\f[R]
Success
.TP
\f[B]>0\f[R]
Fail
.SH BUGS
.PP
Bugs you may find.
First search for related issues on
https://github.com/nyxnor/onionjuggler/issues, if not solved, open a new
one.
.SH SEE ALSO
.PP
onionjuggler.conf(5), onionjuggler-TUI(8),
onionjuggler-cli-auth-client(8), onionjuggler-cli-auth-server(8),
onionjuggler-cli-web(8), tor(1)
.SH COPYRIGHT
.PP
Copyright \[co] 2021 OnionJuggler developers (MIT) This is free
software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
.SH AUTHORS
Written by nyxnor (nyxnor\[at]protonmail.com).
