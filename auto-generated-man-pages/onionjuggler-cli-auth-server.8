.\" Automatically generated by Pandoc 2.9.2.1
.\"
.TH "ONIONJUGGLER-CLI-AUTH0-SERVER" "8" "2022-08-29" "onionjuggler-cli-auth-server 0.0.1" "Tor's System Manager Manual"
.hy
.SH NAME
.PP
onionjuggler-cli-auth-server - Manage onion service server side
authorization
.SH SYNOPSIS
.PP
\f[B]onionjuggler-cli-auth-server\f[R]
[\f[B]--option\f[R]<=\f[I]ARGUMENT\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]--on\f[R]]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
[\f[B]--client-pub-file\f[R]=<\f[I]CLIENT_PUB_FILE\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]--on\f[R]]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
[\f[B]--client\f[R]=<\f[I]CLIENT\f[R]>]
[\f[B]--client-pub-config\f[R]=<\f[I]CLIENT_PUB_CONFIG\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]--on\f[R]]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
[\f[B]--client\f[R]=<\f[I]CLIENT\f[R]>]
[\f[B]--client-pub-key\f[R]=<\f[I]CLIENT_PUB_KEY\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]--off\f[R]]
[\f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
[\f[B]--client\f[R]=<\f[I]\[at]all\f[R]|\f[I]CLIENT1\f[R],\f[I]CLIENT2\f[R],\f[I]...\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]--list\f[R]]
[\f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R]
[\f[B]--signal\f[R]=<\f[I]reload\f[R]|\f[I]restart\f[R]|\f[I]none\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server [--getconf]\f[R]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server [--getopt]\f[R]
[\f[B]--service\f[R]=<\f[I]SERVICE\f[R]>]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R]
[\f[B]-V\f[R]|\f[B]--version\f[R]]
.PD 0
.P
.PD
\f[B]onionjuggler-cli-auth-server\f[R] [\f[B]-h\f[R]|\f[B]--help\f[R]]
.SH DESCRIPTION
.PP
\f[B]onionjuggler-cli-auth-server\f[R] helps manage server side onion
authorization.
.SH OPTIONS
.PP
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERVICE\f[R]>
\f[B]--client-pub-file\f[R]=<\f[I]CLIENT_PUB_FILE\f[R]>
\f[B]--replace-file\f[R]
.PD 0
.P
.PD
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERVICE\f[R]>
\f[B]--client-pub-config\f[R]=<\f[I]CLIENT_PUB_CONFIG\f[R]>
\f[B]--client\f[R] \f[B]--replace-file\f[R]
.PD 0
.P
.PD
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERVICE\f[R]>
\f[B]--client\f[R]=<\f[I]CLIENT\f[R]>
\f[B]--client-pub-key\f[R]=<\f[I]CLIENT_PUB_KEY\f[R]>
\f[B]--replace-file\f[R]
.PD 0
.P
.PD
.TP
\f[B]--on\f[R] \f[B]--service\f[R]=<\f[I]SERVICE\f[R]> \f[B]--client\f[R]=<\f[I]CLIENT\f[R]>
Authorize a client to your service.
A key pair of public and private keys will be generated, keys are sent
to stdout and you should send to the client.
A CLIENT.auth file will be created on
HiddenServiceDir/authorized_clients folder.
If no key is specified, then a key pair will be generated.File(s)
modified: HiddenServiceDir/authorized_clients/
.RS
.IP
.nf
\f[C]
onionjuggler-cli-auth-server --on --service=ssh --client-pub-file=/home/user/bob.auth
onionjuggler-cli-auth-server --on --service=ssh --client=bob --client-pub-config=descriptor:x25519:UQYM2MJ4CKZU25JABR3Z5L2QP3552EH2BUOIZC2XVULY2QRGXUVQ
onionjuggler-cli-auth-server --on --service=ssh --client=bob --client-pub-key=UQYM2MJ4CKZU25JABR3Z5L2QP3552EH2BUOIZC2XVULY2QRGXUVQ
onionjuggler-cli-auth-server --on --service=ssh --client=bob
\f[R]
.fi
.RE
.TP
\f[B]--off\f[R] \f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]> \f[B]--client\f[R]=<\f[I]\[at]all\f[R]|\f[I]CLIENT1\f[R],\f[I]CLIENT2\f[R],\f[I]...\f[R]>
Deauthorize from your service a client that is inside
HiddenServiceDir/authorized_clients folder.
File(s) modified: HiddenServiceDir/authorized_clients/
.RS
.IP
.nf
\f[C]
onionjuggler-cli-auth-server --off --service=ssh --client=alice
onionjuggler-cli-auth-server --off --service=ssh --client=alice,bob
onionjuggler-cli-auth-server --off --service=ssh,xmpp --client=alice
onionjuggler-cli-auth-server --off --service=ssh,xmpp --client=alice,bob
onionjuggler-cli-auth-server --off --service=\[at]all --client=alice,bob
onionjuggler-cli-auth-server --off --service=\[at]all --client=\[at]all
\f[R]
.fi
.RE
.TP
\f[B]--list\f[R] \f[B]--service\f[R]=<\f[I]\[at]all\f[R]|\f[I]SERV1\f[R],\f[I]SERV2\f[R],\f[I]...\f[R]>
List authorized clients and the respective public keys that are inside
HiddenServiceDir/authorized_clients folder.
File(s) modified: none
.RS
.IP
.nf
\f[C]
onionjuggler-cli-auth-server --list --service=ssh
onionjuggler-cli-auth-server --list --service=ssh,xmpp
onionjuggler-cli-auth-server --list --service=\[at]all
\f[R]
.fi
.RE
.TP
\f[B]-V\f[R], \f[B]--version\f[R]
Print version information.
.TP
\f[B]--getconf\f[R]
Print configuration in the format \f[B]key\f[R]=\[dq]\f[I]val\f[R]\[dq].
.TP
\f[B]--getopt\f[R]
Print option parsing results.
.TP
\f[B]--signal\f[R]=<\f[I]reload\f[R]|\f[I]hup\f[R]|\f[I]restart\f[R]|\f[I]int\f[R]|\f[I]no\f[R]|\f[I]none\f[R]>
Send specific signal commands to the tor daemon.
Sending the \f[I]restart|int\f[R] signal is useful for correcting a
previously broken tor configuration.
Sending \f[I]no|none\f[R] signal is useful when running consecutive
commands to avoid tor signaling newnym everytime tor is hupped, then at
last signal tor hup to tor reload its configuration and apply changes.
(Default: reload|hup).
.TP
\f[B]-h\f[R], \f[B]--help\f[R]
Display the script help message.
Abscense of any parameter will also have the same effect.
.RS
.IP
.nf
\f[C]
onionjuggler-cli-auth-server -h
onionjuggler-cli-auth-server --help
\f[R]
.fi
.RE
.SH ENVIRONMENT
.TP
\f[B]ONIONJUGGLER_SKIP_PRE_TOR_CHECK\f[R]
If set to 1, skip pre run tor check to allow the script to start running
if the tor is failing to parse its configuration.
Note it does not disable the last tor check to apply configuration
changes, that is, if the configuration is still invalid, nothing will be
changed.
This option is useful if you are certain the configuration check will be
fixed by the command.
As the scripts requires root and you are probably calling the script
from an unpriviliged user, preserve the variable value through
environment changes by assigning it after the command to run the
onionjuggler script as another user and before the script name:
.RS
.IP
.nf
\f[C]
sudo ONIONJUGGLER_SKIP_PRE_TOR_CHECK=1 onionjuggler-cli-auth-server
doas ONIONJUGGLER_SKIP_PRE_TOR_CHECK=1 onionjuggler-cli-auth-server
\f[R]
.fi
.RE
.SH FILES
.TP
\f[B]/usr/share/onionjuggler/defaults.sh\f[R]
Default library
.TP
\f[B]/etc/onionjuggler/onionjuggler.conf\f[R]
Default system configuration file.
.TP
\f[B]/etc/onionjuggler/conf.d/*.conf\f[R]
Local configuration files that overrrite the default one.
.SH EXIT VALUE
.TP
\f[B]0\f[R]
Success
.TP
\f[B]>0\f[R]
Fail
.SH BUGS
.PP
Bugs you may find.
First search for related issues on
https://github.com/nyxnor/onionjuggler/issues, if not solved, open a new
one.
.SH SEE ALSO
.PP
onionjuggler.conf(5), onionjuggler-tui(8),
onionjuggler-cli-auth-client(8), onionjuggler-cli-web(8),
onionjuggler-cli(8), tor(1)
.SH COPYRIGHT
.PP
Copyright \[co] 2021 OnionJuggler developers (MIT) This is free
software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.
.SH AUTHORS
Written by nyxnor (nyxnor\[at]protonmail.com).
